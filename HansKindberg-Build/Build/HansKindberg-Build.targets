<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
	<Import Project="HansKindberg-Build-XmlTransformation.targets" />
	<PropertyGroup>
		<BuildDependsOn>
			$(BuildDependsOn);
			CopyFilesToTargetDirectory
		</BuildDependsOn>
	</PropertyGroup>
	<PropertyGroup>
		<CopyFilesToTargetDirectoryDependsOn>
			BeforeCopyFilesToTargetDirectory;
			CoreCopyFilesToTargetDirectory;
			AfterCopyFilesToTargetDirectory
		</CopyFilesToTargetDirectoryDependsOn>
		<CoreCopyFilesToTargetDirectoryDependsOn />
	</PropertyGroup>
	<Target Name="AfterCopyFilesToTargetDirectory" />
	<Target Name="BeforeCopyFilesToTargetDirectory" />
	<Target
		Name="CopyFilesToTargetDirectory"
		DependsOnTargets="$(CopyFilesToTargetDirectoryDependsOn)"
	/>
	<Target
		Name="CoreCopyFilesToTargetDirectory"
		Condition="Exists($(OutDir)) AND @(FileToCopyToTargetDirectory) != ''"
		DependsOnTargets="$(CoreCopyFilesToTargetDirectoryDependsOn)"
	>
		<Message
			Condition="!Exists('$(OutDir)%(RecursiveDir)%(Filename)%(Extension)') OR $([System.DateTime]::Parse('%(ModifiedTime)').Ticks) > $([System.IO.File]::GetLastWriteTime('$(OutDir)%(RecursiveDir)%(Filename)%(Extension)').Ticks)"
			Importance="$(MessageImportance)"
			Text="Target 'CoreCopyFilesToTargetDirectory': Copying '%(FileToCopyToTargetDirectory.FullPath)' to '$(OutDir)%(RecursiveDir)%(Filename)%(Extension)'."
		/>
		<Copy
			Condition="!Exists('$(OutDir)%(RecursiveDir)%(Filename)%(Extension)') OR $([System.DateTime]::Parse('%(ModifiedTime)').Ticks) > $([System.IO.File]::GetLastWriteTime('$(OutDir)%(RecursiveDir)%(Filename)%(Extension)').Ticks)"
			DestinationFiles="$(OutDir)%(RecursiveDir)%(Filename)%(Extension)"
            SourceFiles="%(FileToCopyToTargetDirectory.FullPath)"
		/>
	</Target>
</Project>